<div class="app-container fade-in bg-white min-h-screen">
    
    <!-- VISTA 1: LISTADO DE USUARIOS (DIRECTORIO) -->
    <div id="users-list-view">
        
        <!-- HEADER -->
        <div class="d-flex align-items-center justify-content-between mb-4 mt-2">
            <button onclick="ViewControllers.users.closeModule()" class="btn btn-light rounded-circle shadow-sm flex-center border" style="width: 45px; height: 45px;">
                <i class="ph-bold ph-arrow-left text-dark fs-5"></i>
            </button>
            <div class="text-end">
                <!-- T√≠tulo con color WARNING/NARANJA -->
                <h2 class="fw-black mb-0 text-warning h4">Directorio</h2>
                <small class="text-muted">Miembros de la Tribu</small>
            </div>
        </div>

        <!-- Buscador -->
        <div class="input-wrapper mb-4 shadow-sm position-relative">
            <i class="ph ph-magnifying-glass text-muted position-absolute top-50 start-0 translate-middle-y ms-3 fs-5"></i>
            <input type="text" id="user-search" class="form-control form-control-lg ps-5 border-0 bg-light" placeholder="Buscar por nombre o c√©dula..." oninput="ViewControllers.users.filterUsers(this.value)" style="border-radius: 1rem;">
        </div>

        <!-- Filtros R√°pidos (Estilo Warning) -->
        <div class="d-flex gap-2 overflow-auto pb-2 mb-2 no-scrollbar">
            <span class="badge bg-warning text-dark border border-warning-subtle rounded-pill px-3 py-2">Todos</span>
            <span class="badge bg-white text-secondary border border-light rounded-pill px-3 py-2">Activos</span>
            <span class="badge bg-white text-secondary border border-light rounded-pill px-3 py-2">Nuevos</span>
        </div>

        <!-- Lista de Usuarios -->
        <div id="user-list-container" class="pb-5 mb-5">
            <!-- Se llena din√°micamente desde JS -->
            <div class="text-center py-5 opacity-50">
                <div class="spinner-border text-warning" role="status"></div>
                <p class="mt-2 small">Cargando la tribu...</p>
            </div>
        </div>

        <!-- BOT√ìN FLOTANTE (FAB) - NUEVO MIEMBRO -->
        <!-- Fixed a 80px del pie, redondo y color Warning -->
        <button onclick="ViewControllers.users.showCreateForm()" 
                class="btn btn-warning text-white shadow-lg rounded-circle flex-center position-fixed" 
                style="bottom: 80px; right: 25px; width: 65px; height: 65px; z-index: 1050; border: 2px solid white;">
            <i class="ph-bold ph-plus fs-2"></i>
        </button>

    </div>

    <!-- VISTA 2: FORMULARIO (CREAR/EDITAR) -->
    <div id="user-form-view" class="hidden">
        
        <div class="d-flex align-items-center gap-3 mb-4">
            <button onclick="ViewControllers.users.backToList()" class="btn btn-light rounded-circle shadow-sm flex-center" style="width: 45px; height: 45px;">
                <i class="ph-bold ph-arrow-left text-dark"></i>
            </button>
            <h4 id="form-title" class="fw-black mb-0 text-dark">Nuevo Miembro</h4>
        </div>

        <form id="user-form" onsubmit="return false;">
            <input type="hidden" id="u-id">

            <!-- Tarjeta 1: Identificaci√≥n -->
            <div class="card border-0 shadow-sm rounded-4 mb-3">
                <div class="card-body">
                    <h6 class="fw-bold text-warning mb-3 text-uppercase small">Identificaci√≥n</h6>
                    
                    <div class="mb-3">
                        <label class="form-label">C√©dula / ID</label>
                        <input type="tel" id="u-cedula" class="form-control form-control-lg fw-bold bg-light" placeholder="000000000" oninput="validators.numberInput(event)">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Pasaporte (Opcional)</label>
                        <div class="input-group">
                            <span class="input-group-text bg-white border-end-0"><i class="ph-bold ph-passport text-warning"></i></span>
                            <input type="text" id="u-pasaporte" class="form-control form-control-lg border-start-0 ps-0 text-uppercase" placeholder="PAS-12345" oninput="ViewControllers.users.validateInput(this, 'passport')">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tarjeta 2: Datos Personales -->
            <div class="card border-0 shadow-sm rounded-4 mb-3">
                <div class="card-body">
                    <h6 class="fw-bold text-warning mb-3 text-uppercase small">Datos Personales</h6>
                    
                    <div class="mb-3">
                        <label class="form-label">Nombre</label>
                        <input type="text" id="u-nombre" class="form-control form-control-lg text-capitalize" placeholder="Nombre" oninput="validators.nameInput(event)">
                    </div>
                    <div class="row g-2 mb-3">
                        <div class="col-6">
                            <label class="form-label">1er Apellido</label>
                            <input type="text" id="u-apellido1" class="form-control form-control-lg text-capitalize" placeholder="Apellido" oninput="validators.nameInput(event)">
                        </div>
                        <div class="col-6">
                            <label class="form-label">2do Apellido</label>
                            <input type="text" id="u-apellido2" class="form-control form-control-lg text-capitalize" placeholder="Apellido" oninput="validators.nameInput(event)">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">M√≥vil (Sinpe)</label>
                        <div class="input-group">
                            <span class="input-group-text bg-white border-end-0 fw-bold text-dark">+506</span>
                            <input type="tel" id="u-movil" class="form-control form-control-lg border-start-0 ps-1 fw-bold" placeholder="00000000" oninput="validators.numberInput(event)" maxlength="8">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Correo Electr√≥nico</label>
                        <input type="email" id="u-email" class="form-control form-control-lg lowercase" placeholder="usuario@email.com" oninput="ViewControllers.users.validateInput(this, 'email')">
                    </div>

                    <div class="row g-2 mb-1">
                        <div class="col-6">
                            <label class="form-label">Tel. Emergencia</label>
                            <input type="tel" id="u-emergencia" class="form-control" placeholder="Tel√©fono" oninput="validators.numberInput(event)" maxlength="8">
                        </div>
                        <div class="col-6">
                            <label class="form-label">Fecha Nac.</label>
                            <input type="date" id="u-nacimiento" class="form-control">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tarjeta 3: Configuraci√≥n -->
            <div class="card border-0 shadow-sm rounded-4 mb-4">
                <div class="card-body">
                    <h6 class="fw-bold text-warning mb-3 text-uppercase small">Configuraci√≥n</h6>
                    
                    <div class="d-flex justify-content-between align-items-center mb-3 p-2 border rounded-3">
                        <div class="d-flex align-items-center gap-2">
                            <i class="ph-fill ph-star text-warning fs-4"></i>
                            <span class="fw-bold">Acumula Puntos</span>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="u-puntos" style="width: 3em; height: 1.5em;">
                        </div>
                    </div>

                    <label class="form-label">Estado</label>
                    <!-- Borde Warning -->
                    <select id="u-estado" class="form-select form-select-lg fw-bold border-2 border-warning" onchange="ViewControllers.users.handleStatusChange()" disabled>
                        <option value="Activo">Activo üü¢</option>
                        <option value="Inactivo">Inactivo ‚ö™</option>
                        <option value="Incapacitado">Incapacitado üè•</option>
                        <option value="Eliminar">Eliminar üî¥</option>
                    </select>

                    <!-- Advertencia Motivacional (Oculta por defecto) -->
                    <div id="delete-warning-box" class="hidden mt-3 p-3 bg-danger-subtle rounded-4 border border-danger">
                        <div class="d-flex gap-3">
                            <i class="ph-fill ph-heart-break text-danger fs-1"></i>
                            <div>
                                <h6 class="fw-bold text-danger mb-1">¬°Atenci√≥n!</h6>
                                <p class="small text-dark mb-0 lh-sm">
                                    "Antes de Eliminar debes comunicarte con la Persona para incentivarlo a volver motivandole" ‚ù§Ô∏è
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BOTONES DE ACCI√ìN (Se inyectan v√≠a JS) -->
            <div id="form-actions" class="d-grid gap-2 pb-5"></div>
        </form>
    </div>
</div>